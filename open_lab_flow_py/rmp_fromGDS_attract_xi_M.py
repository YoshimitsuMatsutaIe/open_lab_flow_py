"""RMP from GDSのアトラクトにおける曲率項を計算"""
import numpy as np
from math import exp, tanh

def attract_M(x, dx, sigma_alpha, sigma_gamma, w_u, w_l, alpha, epsilon):
    """アトラクター慣性行列を計算"""
    x0 = x[0, 0]
    y0 = x[1, 0]
    z0 = x[2, 0]
    x_norm = np.linalg.norm(x)
    
    # dx0 = dx[0, 0]
    # dy0 = dx[1, 0]
    # dz0 = dx[2, 0]
    
    M = np.array([
        [(w_l*(1 - exp(-(x_norm**2)**1.0/(2*sigma_gamma**2))) + w_u*exp(-(x_norm**2)**1.0/(2*sigma_gamma**2)))*(epsilon + x0**2*(1 - exp(-2*alpha*(x_norm**2)**0.5))**2*(1 - exp(-(x_norm**2)**1.0/(2*sigma_alpha**2)))*(x_norm**2)**(-1.0)/(1 + exp(-2*alpha*(x_norm**2)**0.5))**2 + exp(-(x_norm**2)**1.0/(2*sigma_alpha**2))), -x0*y0*(-w_l*(exp((x_norm**2)**1.0/(2*sigma_gamma**2)) - 1) - w_u)*(exp((x_norm**2)**1.0/(2*sigma_alpha**2)) - 1)*(x_norm**2)**(-1.0)*exp(-(sigma_alpha**2 + sigma_gamma**2)*(x_norm**2)**1.0/(2*sigma_alpha**2*sigma_gamma**2))*tanh(alpha*(x_norm**2)**0.5)**2, -x0*z0*(-w_l*(exp((x_norm**2)**1.0/(2*sigma_gamma**2)) - 1) - w_u)*(exp((x_norm**2)**1.0/(2*sigma_alpha**2)) - 1)*(x_norm**2)**(-1.0)*exp(-(sigma_alpha**2 + sigma_gamma**2)*(x_norm**2)**1.0/(2*sigma_alpha**2*sigma_gamma**2))*tanh(alpha*(x_norm**2)**0.5)**2], 
        [-x0*y0*(-w_l*(exp((x_norm**2)**1.0/(2*sigma_gamma**2)) - 1) - w_u)*(exp((x_norm**2)**1.0/(2*sigma_alpha**2)) - 1)*(x_norm**2)**(-1.0)*exp(-(sigma_alpha**2 + sigma_gamma**2)*(x_norm**2)**1.0/(2*sigma_alpha**2*sigma_gamma**2))*tanh(alpha*(x_norm**2)**0.5)**2, (w_l*(1 - exp(-(x_norm**2)**1.0/(2*sigma_gamma**2))) + w_u*exp(-(x_norm**2)**1.0/(2*sigma_gamma**2)))*(epsilon + y0**2*(1 - exp(-2*alpha*(x_norm**2)**0.5))**2*(1 - exp(-(x_norm**2)**1.0/(2*sigma_alpha**2)))*(x_norm**2)**(-1.0)/(1 + exp(-2*alpha*(x_norm**2)**0.5))**2 + exp(-(x_norm**2)**1.0/(2*sigma_alpha**2))), -y0*z0*(-w_l*(exp((x_norm**2)**1.0/(2*sigma_gamma**2)) - 1) - w_u)*(exp((x_norm**2)**1.0/(2*sigma_alpha**2)) - 1)*(x_norm**2)**(-1.0)*exp(-(sigma_alpha**2 + sigma_gamma**2)*(x_norm**2)**1.0/(2*sigma_alpha**2*sigma_gamma**2))*tanh(alpha*(x_norm**2)**0.5)**2], 
        [-x0*z0*(-w_l*(exp((x_norm**2)**1.0/(2*sigma_gamma**2)) - 1) - w_u)*(exp((x_norm**2)**1.0/(2*sigma_alpha**2)) - 1)*(x_norm**2)**(-1.0)*exp(-(sigma_alpha**2 + sigma_gamma**2)*(x_norm**2)**1.0/(2*sigma_alpha**2*sigma_gamma**2))*tanh(alpha*(x_norm**2)**0.5)**2, -y0*z0*(-w_l*(exp((x_norm**2)**1.0/(2*sigma_gamma**2)) - 1) - w_u)*(exp((x_norm**2)**1.0/(2*sigma_alpha**2)) - 1)*(x_norm**2)**(-1.0)*exp(-(sigma_alpha**2 + sigma_gamma**2)*(x_norm**2)**1.0/(2*sigma_alpha**2*sigma_gamma**2))*tanh(alpha*(x_norm**2)**0.5)**2, (w_l*(1 - exp(-(x_norm**2)**1.0/(2*sigma_gamma**2))) + w_u*exp(-(x_norm**2)**1.0/(2*sigma_gamma**2)))*(epsilon + z0**2*(1 - exp(-2*alpha*(x_norm**2)**0.5))**2*(1 - exp(-(x_norm**2)**1.0/(2*sigma_alpha**2)))*(x_norm**2)**(-1.0)/(1 + exp(-2*alpha*(x_norm**2)**0.5))**2 + exp(-(x_norm**2)**1.0/(2*sigma_alpha**2)))]
        ])
    
    return M



def attract_xi_M(x, dx, sigma_alpha, sigma_gamma, w_u, w_l, alpha, epsilon):
    """アトラクター力における曲率項を計算"""
    x0 = x[0, 0]
    y0 = x[1, 0]
    z0 = x[2, 0]
    x_norm = np.linalg.norm(x)
    
    dx0 = dx[0, 0]
    dy0 = dx[1, 0]
    dz0 = dx[2, 0]
    
    #sigma_alpha, sigma_gamma, w_u, w_l, alpha, epsilon = 1, 1, 1, 1, 1, 1
    
    xi_M = np.array([
        [x_norm**(-61.0)*(dx0*(dx0*x0*(1.0*sigma_alpha**2*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((sigma_alpha**2 + 6*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + sigma_gamma**2*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**1.0*(-4.0*alpha*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**5.5 + 4.0*alpha*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 + 2.0*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 2*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + 1.0*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**7.0)*exp((5 + (sigma_alpha**2 + 2*sigma_gamma**2)/sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2)))*x_norm**7.0*exp((2*sigma_alpha**2 + 7*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + (dy0*y0 + dz0*z0)*(1.0*sigma_alpha**2*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((sigma_alpha**2 + 5*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + sigma_gamma**2*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**1.0*(-4.0*alpha*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**4.5 + 4.0*alpha*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.5 + 2.0*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.0 + 1.0*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**6.0)*exp((2 + (sigma_alpha**2 + 2*sigma_gamma**2)/(2*sigma_gamma**2))*x_norm**1.0/sigma_alpha**2))*x_norm**8.0*exp((sigma_alpha**2 + 4*sigma_gamma**2)*x_norm**1.0/(sigma_alpha**2*sigma_gamma**2)))*x_norm**46.0*exp((27*sigma_alpha**2 + 38*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dx0*x_norm**45.0*(-4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**14.5*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.5*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*dx0*sigma_alpha**2*x0*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dx0*sigma_gamma**2*x0*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**9.0*(-4.0*alpha*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**5.5 + 4.0*alpha*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 + 2.0*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 2*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + 1.0*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**7.0)*exp((5 + (7*sigma_alpha**2 + 8*sigma_gamma**2)/sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2)) + 2.0*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - 1.0*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(dy0*y0 + dz0*z0)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)))*exp((23*sigma_alpha**2 + 39*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - (1 - exp(2*alpha*x_norm**0.5))*(dy0*(dz0*x0*y0*z0*x_norm**8.0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**5.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 - 2.0*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 + 1.0*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0) + (dx0*y0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0) + dy0*x0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0))*x_norm**7.0) + dz0*(dy0*x0*y0*z0*x_norm**8.0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**5.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 - 2.0*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 + 1.0*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0) + (dx0*z0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0) + dz0*x0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0))*x_norm**7.0))*x_norm**46.0*exp((15*sigma_alpha**2 + 26*sigma_gamma**2)*x_norm**1.0/(sigma_alpha**2*sigma_gamma**2)) + (dy0*(-4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0*y0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0*y0*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - dx0*sigma_alpha**2*sigma_gamma**2*y0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*dy0*sigma_alpha**2*x0*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((7*sigma_alpha**2 + 11*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dy0*sigma_gamma**2*x0*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**9.0*(-4.0*alpha*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**4.5 + 4.0*alpha*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.5 + 2.0*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.0 + 1.0*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**6.0)*exp((2 + (7*sigma_alpha**2 + 8*sigma_gamma**2)/(2*sigma_gamma**2))*x_norm**1.0/sigma_alpha**2) + 2.0*sigma_alpha**2*sigma_gamma**2*x0*y0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - 1.0*sigma_alpha**2*x0*y0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(dx0*x0 + dz0*z0)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*sigma_gamma**2*x0*y0*(1 - exp(2*alpha*x_norm**0.5))**2*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2))) + dz0*(-4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0*z0*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - dx0*sigma_alpha**2*sigma_gamma**2*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*dz0*sigma_alpha**2*x0*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((7*sigma_alpha**2 + 11*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dz0*sigma_gamma**2*x0*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**9.0*(-4.0*alpha*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**4.5 + 4.0*alpha*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.5 + 2.0*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.0 + 1.0*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**6.0)*exp((2 + (7*sigma_alpha**2 + 8*sigma_gamma**2)/(2*sigma_gamma**2))*x_norm**1.0/sigma_alpha**2) + 2.0*sigma_alpha**2*sigma_gamma**2*x0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - 1.0*sigma_alpha**2*x0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(dx0*x0 + dy0*y0)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*sigma_gamma**2*x0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2))))*x_norm**46.0*exp((23*sigma_alpha**2 + 40*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)))*exp(-(31*sigma_alpha**2 + 53*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2))/(sigma_alpha**2*sigma_gamma**2*(exp(2*alpha*x_norm**0.5) + 1)**3)], 
        [x_norm**(-61.0)*(dy0*(dy0*y0*(1.0*sigma_alpha**2*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((sigma_alpha**2 + 6*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + sigma_gamma**2*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**1.0*(-4.0*alpha*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**5.5 + 4.0*alpha*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 + 2.0*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 2*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + 1.0*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**7.0)*exp((5 + (sigma_alpha**2 + 2*sigma_gamma**2)/sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2)))*x_norm**7.0*exp((2*sigma_alpha**2 + 7*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + (dx0*x0 + dz0*z0)*(1.0*sigma_alpha**2*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((sigma_alpha**2 + 5*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + sigma_gamma**2*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**1.0*(-4.0*alpha*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**4.5 + 4.0*alpha*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.5 + 2.0*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.0 + 1.0*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**6.0)*exp((2 + (sigma_alpha**2 + 2*sigma_gamma**2)/(2*sigma_gamma**2))*x_norm**1.0/sigma_alpha**2))*x_norm**8.0*exp((sigma_alpha**2 + 4*sigma_gamma**2)*x_norm**1.0/(sigma_alpha**2*sigma_gamma**2)))*x_norm**46.0*exp((27*sigma_alpha**2 + 38*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dy0*x_norm**45.0*(-4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**14.5*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.5*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*dy0*sigma_alpha**2*y0*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dy0*sigma_gamma**2*y0*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**9.0*(-4.0*alpha*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**5.5 + 4.0*alpha*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 + 2.0*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 2*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + 1.0*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**7.0)*exp((5 + (7*sigma_alpha**2 + 8*sigma_gamma**2)/sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2)) + 2.0*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - 1.0*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(dx0*x0 + dz0*z0)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)))*exp((23*sigma_alpha**2 + 39*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - (1 - exp(2*alpha*x_norm**0.5))*(dx0*(dz0*x0*y0*z0*x_norm**8.0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**5.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 - 2.0*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 + 1.0*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0) + (dx0*y0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0) + dy0*x0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0))*x_norm**7.0) + dz0*(dx0*x0*y0*z0*x_norm**8.0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**5.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 - 2.0*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 + 1.0*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0) + (dy0*z0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0) + dz0*y0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0))*x_norm**7.0))*x_norm**46.0*exp((15*sigma_alpha**2 + 26*sigma_gamma**2)*x_norm**1.0/(sigma_alpha**2*sigma_gamma**2)) + (dx0*(-4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0*y0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0*y0*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*dx0*sigma_alpha**2*y0*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((7*sigma_alpha**2 + 11*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dx0*sigma_gamma**2*y0*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**9.0*(-4.0*alpha*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**4.5 + 4.0*alpha*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.5 + 2.0*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.0 + 1.0*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**6.0)*exp((2 + (7*sigma_alpha**2 + 8*sigma_gamma**2)/(2*sigma_gamma**2))*x_norm**1.0/sigma_alpha**2) - dy0*sigma_alpha**2*sigma_gamma**2*x0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 2.0*sigma_alpha**2*sigma_gamma**2*x0*y0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - 1.0*sigma_alpha**2*x0*y0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(dy0*y0 + dz0*z0)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*sigma_gamma**2*x0*y0*(1 - exp(2*alpha*x_norm**0.5))**2*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2))) + dz0*(-4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0*z0*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - dy0*sigma_alpha**2*sigma_gamma**2*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*dz0*sigma_alpha**2*y0*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((7*sigma_alpha**2 + 11*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dz0*sigma_gamma**2*y0*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**9.0*(-4.0*alpha*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**4.5 + 4.0*alpha*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.5 + 2.0*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.0 + 1.0*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**6.0)*exp((2 + (7*sigma_alpha**2 + 8*sigma_gamma**2)/(2*sigma_gamma**2))*x_norm**1.0/sigma_alpha**2) + 2.0*sigma_alpha**2*sigma_gamma**2*y0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - 1.0*sigma_alpha**2*y0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(dx0*x0 + dy0*y0)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*sigma_gamma**2*y0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2))))*x_norm**46.0*exp((23*sigma_alpha**2 + 40*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)))*exp(-(31*sigma_alpha**2 + 53*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2))/(sigma_alpha**2*sigma_gamma**2*(exp(2*alpha*x_norm**0.5) + 1)**3)], 
        [x_norm**(-61.0)*(dz0*(dz0*z0*(1.0*sigma_alpha**2*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((sigma_alpha**2 + 6*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + sigma_gamma**2*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**1.0*(-4.0*alpha*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**5.5 + 4.0*alpha*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 + 2.0*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 2*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + 1.0*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**7.0)*exp((5 + (sigma_alpha**2 + 2*sigma_gamma**2)/sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2)))*x_norm**7.0*exp((2*sigma_alpha**2 + 7*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + (dx0*x0 + dy0*y0)*(1.0*sigma_alpha**2*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((sigma_alpha**2 + 5*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + sigma_gamma**2*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**1.0*(-4.0*alpha*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**4.5 + 4.0*alpha*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.5 + 2.0*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.0 + 1.0*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**6.0)*exp((2 + (sigma_alpha**2 + 2*sigma_gamma**2)/(2*sigma_gamma**2))*x_norm**1.0/sigma_alpha**2))*x_norm**8.0*exp((sigma_alpha**2 + 4*sigma_gamma**2)*x_norm**1.0/(sigma_alpha**2*sigma_gamma**2)))*x_norm**46.0*exp((27*sigma_alpha**2 + 38*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dz0*x_norm**45.0*(-4.0*alpha*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**14.5*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 4.0*alpha*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.5*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*dz0*sigma_alpha**2*z0*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dz0*sigma_gamma**2*z0*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**9.0*(-4.0*alpha*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**5.5 + 4.0*alpha*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 + 2.0*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 2*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + 1.0*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**7.0)*exp((5 + (7*sigma_alpha**2 + 8*sigma_gamma**2)/sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2)) + 2.0*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - 1.0*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(dx0*x0 + dy0*y0)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(dx0*x0 + dy0*y0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**15.0*exp((7*sigma_alpha**2 + 13*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)))*exp((23*sigma_alpha**2 + 39*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - (1 - exp(2*alpha*x_norm**0.5))*(dx0*(dy0*x0*y0*z0*x_norm**8.0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**5.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 - 2.0*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 + 1.0*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0) + (dx0*z0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0) + dz0*x0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0))*x_norm**7.0) + dy0*(dx0*x0*y0*z0*x_norm**8.0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**5.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.5 - 2.0*sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 + 1.0*sigma_alpha**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 - 1.0*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0) + (dy0*z0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0) + dz0*y0*(4.0*alpha*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**6.5 - 4.0*alpha*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.5 - 2.0*sigma_alpha**2*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**6.0 + sigma_alpha**2*sigma_gamma**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 + 1.0*sigma_alpha**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0 - 1.0*sigma_gamma**2*z0**2*(1 - exp(2*alpha*x_norm**0.5))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**7.0))*x_norm**7.0))*x_norm**46.0*exp((15*sigma_alpha**2 + 26*sigma_gamma**2)*x_norm**1.0/(sigma_alpha**2*sigma_gamma**2)) + (dx0*(-4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 4.0*alpha*sigma_alpha**2*sigma_gamma**2*x0*z0*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*dx0*sigma_alpha**2*z0*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((7*sigma_alpha**2 + 11*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dx0*sigma_gamma**2*z0*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**9.0*(-4.0*alpha*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**4.5 + 4.0*alpha*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.5 + 2.0*sigma_alpha**2*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.0 + 1.0*x0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**6.0)*exp((2 + (7*sigma_alpha**2 + 8*sigma_gamma**2)/(2*sigma_gamma**2))*x_norm**1.0/sigma_alpha**2) - dz0*sigma_alpha**2*sigma_gamma**2*x0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 2.0*sigma_alpha**2*sigma_gamma**2*x0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - 1.0*sigma_alpha**2*x0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(dy0*y0 + dz0*z0)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*sigma_gamma**2*x0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(dy0*y0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2))) + dy0*(-4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 4.0*alpha*sigma_alpha**2*sigma_gamma**2*y0*z0*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.5*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*dy0*sigma_alpha**2*z0*(w_l - w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*(epsilon*(exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/sigma_alpha**2) - y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*exp(x_norm**1.0/(2*sigma_alpha**2)) + (exp(2*alpha*x_norm**0.5) + 1)**2*x_norm**1.0*exp(x_norm**1.0/(2*sigma_alpha**2)))*exp((7*sigma_alpha**2 + 11*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + dy0*sigma_gamma**2*z0*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*x_norm**9.0*(-4.0*alpha*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*x_norm**4.5 + 4.0*alpha*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.5 + 2.0*sigma_alpha**2*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**4.0 + 1.0*y0**2*(1 - exp(2*alpha*x_norm**0.5))**2*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**5.0 - 1.0*(exp(2*alpha*x_norm**0.5) + 1)**3*x_norm**6.0)*exp((2 + (7*sigma_alpha**2 + 8*sigma_gamma**2)/(2*sigma_gamma**2))*x_norm**1.0/sigma_alpha**2) - dz0*sigma_alpha**2*sigma_gamma**2*y0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 2.0*sigma_alpha**2*sigma_gamma**2*y0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**13.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) - 1.0*sigma_alpha**2*y0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(1 - exp(x_norm**1.0/(2*sigma_alpha**2)))*(w_l - w_u)*(dx0*x0 + dz0*z0)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)) + 1.0*sigma_gamma**2*y0*z0*(1 - exp(2*alpha*x_norm**0.5))**2*(dx0*x0 + dz0*z0)*(-w_l*(1 - exp(x_norm**1.0/(2*sigma_gamma**2))) + w_u)*(exp(2*alpha*x_norm**0.5) + 1)*x_norm**14.0*exp((7*sigma_alpha**2 + 12*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2))))*x_norm**46.0*exp((23*sigma_alpha**2 + 40*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2)))*exp(-(31*sigma_alpha**2 + 53*sigma_gamma**2)*x_norm**1.0/(2*sigma_alpha**2*sigma_gamma**2))/(sigma_alpha**2*sigma_gamma**2*(exp(2*alpha*x_norm**0.5) + 1)**3)]
        ])
    
    return xi_M
